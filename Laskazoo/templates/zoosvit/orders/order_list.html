{% extends 'zoosvit/core/base.html' %}
{% load static %}

{% block title %}–ú–æ—ó –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'zoosvit/css/users/profile.css' %}">
  <style>
    .orders-container {
      padding: 20px;
    }
    .order-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #e0e0e0;
    }
    .order-number {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--color-primary);
    }
    .order-status {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
    }
    .status-cart {
      background: #f0f0f0;
      color: #666;
    }
    .status-in_process {
      background: #fff3cd;
      color: #856404;
    }
    .status-processing {
      background: #cff4fc;
      color: #055160;
    }
    .status-shipped {
      background: #d1ecf1;
      color: #0c5460;
    }
    .status-completed {
      background: #d4edda;
      color: #155724;
    }
    .status-canceled {
      background: #f8d7da;
      color: #721c24;
    }
    .order-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }
    .order-info-item {
      font-size: 0.9rem;
    }
    .order-info-label {
      color: #666;
      margin-right: 8px;
    }
    .order-items {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 12px;
      margin-top: 12px;
    }
    .order-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #e0e0e0;
    }
    .order-item:last-child {
      border-bottom: none;
    }
    .item-name {
      flex: 1;
      font-size: 0.9rem;
    }
    .item-variant {
      font-size: 0.8rem;
      color: #666;
    }
    .item-qty {
      margin: 0 16px;
      font-size: 0.9rem;
      color: #666;
    }
    .item-price {
      font-weight: 600;
      color: var(--color-primary);
    }
    .order-total {
      text-align: right;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 2px solid #e0e0e0;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--color-primary);
    }
    .empty-orders {
      text-align: center;
      padding: 60px 20px;
      color: #666;
    }
    .empty-orders img {
      width: 120px;
      opacity: 0.5;
      margin-bottom: 20px;
    }
    .empty-orders a {
      color: var(--color-primary);
      text-decoration: none;
      font-weight: 500;
    }
  </style>
{% endblock %}

{% block content %}
<div class="profile-wrapper">
  <!-- –°–∞–π–¥–±–∞—Ä -->
  <aside class="profile-sidebar">
    <ul class="profile-nav">
      <li><a href="{% url 'users:profile' %}">–û—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ</a></li>
      <li class="active"><a href="{% url 'orders:list' %}">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</a></li>
      <li><a href="{% url 'favourites:list' %}">–û–±—Ä–∞–Ω–µ</a></li>
    </ul>
  </aside>

  <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <section class="profile-main">
    <h1 class="profile-title">–ú–æ—ó –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h1>

    <div class="orders-container">
      {% if orders %}
        {% for order in orders %}
          <div class="order-card">
            <div class="order-header">
              <div>
                <div class="order-number">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚Ññ{{ order.order_number|default:order.id }}</div>
                <div style="font-size: 0.85rem; color: #666; margin-top: 4px;">
                  {{ order.created_at|date:"d.m.Y H:i" }}
                </div>
              </div>
              <span class="order-status status-{{ order.status }}">
                {{ order.get_status_display }}
              </span>
            </div>

            <div class="order-info">
              <div class="order-info-item">
                <span class="order-info-label">–ó–∞–º–æ–≤–Ω–∏–∫:</span>
                <strong>{{ order.full_name }}</strong>
              </div>
              <div class="order-info-item">
                <span class="order-info-label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
                {{ order.phone }}
              </div>
              <div class="order-info-item">
                <span class="order-info-label">Email:</span>
                {{ order.email }}
              </div>
              <div class="order-info-item">
                <span class="order-info-label">–î–æ—Å—Ç–∞–≤–∫–∞:</span>
                {{ order.get_delivery_condition_display }}
              </div>
            </div>

            {% if order.delivery_address %}
              <div style="margin-bottom: 12px;">
                <span class="order-info-label">–ê–¥—Ä–µ—Å–∞:</span>
                {{ order.delivery_address }}
              </div>
            {% endif %}

            {% if order.comment %}
              <div style="margin-bottom: 12px;">
                <span class="order-info-label">–ö–æ–º–µ–Ω—Ç–∞—Ä:</span>
                {{ order.comment }}
              </div>
            {% endif %}

            <div class="order-items">
              <div style="font-weight: 600; margin-bottom: 8px;">–¢–æ–≤–∞—Ä–∏:</div>
              {% for item in order.items.all %}
                <div class="order-item">
                  <div class="item-name">
                    {{ item.product.name }}
                    {% if item.variant %}
                      <div class="item-variant">
                        {{ item.variant.sku }}
                        {% if item.variant.weight %} ‚Ä¢ {{ item.variant.weight }}–∫–≥{% endif %}
                        {% if item.variant.size %} ‚Ä¢ {{ item.variant.size }}{% endif %}
                      </div>
                    {% endif %}
                  </div>
                  <div class="item-qty">{{ item.quantity }} —à—Ç</div>
                  <div class="item-price">{{ item.line_total }} –≥—Ä–Ω</div>
                </div>
              {% endfor %}
              
              <div class="order-total">
                –ó–∞–≥–∞–ª–æ–º: {{ order.total_amount }} –≥—Ä–Ω
              </div>
            </div>

            {% if order.status == 'in_process' %}
              <div style="margin-top: 16px; padding: 12px; background: #fff3cd; border-radius: 8px; font-size: 0.9rem;">
                ‚è≥ –û—á—ñ–∫—É–π—Ç–µ –¥–∑–≤—ñ–Ω–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
              </div>
            {% elif order.status == 'processing' %}
              <div style="margin-top: 16px; padding: 12px; background: #cff4fc; border-radius: 8px; font-size: 0.9rem;">
                üìã –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
              </div>
            {% elif order.status == 'shipped' %}
              <div style="margin-top: 16px; padding: 12px; background: #d1ecf1; border-radius: 8px; font-size: 0.9rem;">
                üöö –í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ –¥–æ—Ä–æ–∑—ñ
              </div>
            {% elif order.status == 'completed' %}
              <div style="margin-top: 16px; padding: 12px; background: #d4edda; border-radius: 8px; font-size: 0.9rem;">
                ‚úÖ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–æ. –î—è–∫—É—î–º–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!
              </div>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <div class="empty-orders">
          <img src="{% static 'zoosvit/img/empty-cart.png' %}" alt="–ù–µ–º–∞—î –∑–∞–º–æ–≤–ª–µ–Ω—å">
          <h3>–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
          <p>–ß–∞—Å —Ü–µ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏!</p>
          <a href="{% url 'products:catalog' %}">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É</a>
        </div>
      {% endif %}
    </div>
  </section>
</div>
{% endblock %}
