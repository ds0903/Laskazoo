{% extends 'manager/base.html' %}

{% block manager_content %}
<div class="manager-header">
  <h1>üì¶ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è #{{ order.order_number|default:order.id }}</h1>
  <a href="{% url 'manager:orders' %}" 
     style="padding: 10px 20px; background: #6c757d; color: white; text-decoration: none; border-radius: 6px; display: inline-block;">
    ‚Üê –ù–∞–∑–∞–¥ –¥–æ —Å–ø–∏—Å–∫—É
  </a>
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px;">
  <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
    <h3 style="margin-top: 0; color: var(--color-primary);">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç–∞</h3>
    <p><strong>–ü–Ü–ë:</strong> {{ order.full_name|default:order.user.get_full_name|default:"‚Äî" }}</p>
    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ order.phone|default:"‚Äî" }}</p>
    <p><strong>Email:</strong> {{ order.email|default:order.user.email }}</p>
    <p><strong>–¢–∏–ø –ø—Ä–æ–¥–∞–∂—É:</strong> {{ order.get_sale_type_display }}</p>
    <p><strong>–°–ø–æ—Å—ñ–± –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {{ order.get_delivery_condition_display }}</p>
    <p><strong>–ê–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {{ order.delivery_address|default:"‚Äî" }}</p>
    {% if order.comment %}
    <p><strong>–ö–æ–º–µ–Ω—Ç–∞—Ä:</strong> {{ order.comment }}</p>
    {% endif %}
  </div>
  
  <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
    <h3 style="margin-top: 0; color: var(--color-primary);">–î–µ—Ç–∞–ª—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h3>
    <p><strong>–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:</strong> {{ order.created_at|date:"d.m.Y H:i" }}</p>
    <p><strong>–û–Ω–æ–≤–ª–µ–Ω–æ:</strong> {{ order.updated_at|date:"d.m.Y H:i" }}</p>
    <p><strong>–°—É–º–∞:</strong> <span style="font-size: 1.5rem; color: var(--color-primary); font-weight: 700;">{{ order.total_amount }} –≥—Ä–Ω</span></p>
    
    <form method="post" style="margin-top: 20px;">
      {% csrf_token %}
      <label style="display: block; margin-bottom: 10px; font-weight: 600;">–ó–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å:</label>
      <select name="status" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 10px;">
        {% for value, label in status_choices %}
          <option value="{{ value }}" {% if order.status == value %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
      <button type="submit" 
              style="width: 100%; padding: 10px 20px; background: var(--color-primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
        üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ —Å—Ç–∞—Ç—É—Å
      </button>
    </form>
  </div>
</div>

<div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
  <h3 style="margin-top: 0; color: var(--color-primary);">–¢–æ–≤–∞—Ä–∏ –≤ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—ñ</h3>
  <table style="width: 100%; border-collapse: collapse;">
    <thead>
      <tr style="background: #f8f9fa;">
        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">–¢–æ–≤–∞—Ä</th>
        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">–í–∞—Ä—ñ–∞–Ω—Ç</th>
        <th style="padding: 12px; text-align: center; border-bottom: 2px solid #dee2e6;">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
        <th style="padding: 12px; text-align: right; border-bottom: 2px solid #dee2e6;">–¶—ñ–Ω–∞</th>
        <th style="padding: 12px; text-align: right; border-bottom: 2px solid #dee2e6;">–°—É–º–∞</th>
      </tr>
    </thead>
    <tbody>
      {% for item in order.items.all %}
      <tr style="border-bottom: 1px solid #dee2e6;">
        <td style="padding: 12px;">
          <strong>{{ item.product.name }}</strong><br>
          <small style="color: #6c757d;">–ê—Ä—Ç–∏–∫—É–ª: {{ item.product.sku }}</small>
        </td>
        <td style="padding: 12px;">
          {% if item.variant %}
            {{ item.variant.sku }}
          {% else %}
            ‚Äî
          {% endif %}
        </td>
        <td style="padding: 12px; text-align: center; font-weight: 600;">{{ item.quantity }}</td>
        <td style="padding: 12px; text-align: right;">{{ item.retail_price }} –≥—Ä–Ω</td>
        <td style="padding: 12px; text-align: right; font-weight: 600;">{{ item.line_total }} –≥—Ä–Ω</td>
      </tr>
      {% endfor %}
      <tr style="background: #f8f9fa; font-weight: 700;">
        <td colspan="4" style="padding: 12px; text-align: right;">–†–ê–ó–û–ú:</td>
        <td style="padding: 12px; text-align: right; font-size: 1.2rem; color: var(--color-primary);">{{ order.total_amount }} –≥—Ä–Ω</td>
      </tr>
    </tbody>
  </table>
</div>
{% endblock %}
